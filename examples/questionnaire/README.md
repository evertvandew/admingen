# Questionnaires example
This project launches a website that can be used to create questionnaires, invite people to fill them in, and
evaluate the results.

It is geared towards questionnaires for psychological evaluations / coaching of individuals. 
For this it assigns a value to each answer, groups them together in a category, and produce the score for each
category.

# Usage

GNU `make` is used to run this website. The `all` default target generates the code for the project, downloads and
installs the external resources needed (well-known HTML/CSS/JS packages), creates and configures the database
used by the server, and starts a development server.

There is also a target that runs a production version of the
server: `deploy`.
This starts the server in a way in which it listens to a UNIX socket `ondervrager.s`.
The web server should handle the SSL wrapping and redirect requests to that socket.
For example `nginx` can be used for this purpose.

# Demonstrated features

## Code Generation
This example uses two files to create the web tool:

The web interface is defined in the file `webinterface.xml`. This file defines:

* The actual web interface. For this, components are used that are defined in the `webif_templates.xml`.
* The datamodel used in both the web interface and the database.
* The Authorization Control Matrix (ACM) for each part of the interface.

The code is generated by specific tools. These tools can be identified in the `Makefile`.
They use a combination of an XML template / macro expansion, and specific tags that the specific tools know
how to handle. `webif_templates.xml` contains a set of components built on `JQuery`. These components are active,
in that they use Javascript to get the relevant values from the data server, and update the screen accordingly.
It will be relatively easy to port to another JS framework like `react` or `angular`. This port only requires changes
to `webif_templates.xml` (plus minor `webinterface.xml` to download the new components, and any remaining
hard-coded bits).

Most of the code finds its way into the `html` directory, after running `make`.

## Generated REST API server
The resources available in the database are exposed using a basic REST API, using the path `/data/<resource name>`.
The REST API supports getting the whole table, getting a single record, updating and deleting an existing record
and creating a new element. Currently, `sqlite3` is used as database, but as `sqlalchemy` is used to interact with
the database, it is trivial to use another DMS.


## Security
Several security features are overlaid on the database:
* Most pages (except those with `Any` clearance) require a user to be logged in.
* In the User table, only users with more rights can modify users with less rights.
* The password is always replaced with a standard tekst when retrieving when retrieving a User record.
* The password can never be updated using the regular API requests. To update it, a special request must be made that also checks the user knows the current password.
* Editors can only see, create or modify records in the same Company.
* Users can only see, create or modify records belonging to themselves.
